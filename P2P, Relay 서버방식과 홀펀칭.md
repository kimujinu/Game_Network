# 4. P2P, Relay 서버 방식과 홀펀칭  

<pre>

P2P (Peer to Peer) : 클라이언트끼리 연결되는 방식
P2P 연결 방식은 2가지로 나뉜다.
1. 방장을 정하여 방장에게 연결하여 방장이 모든 커넥션을 가지고있는 연결방식
    장점 : 커넥션 수가 적음, 방장이 심판역할이 가능함.
    단점 : 방장이 게임을 나가거나 커넥션이 끊어지면 처리가 까다롭다.
2. 모두에게 연결을 하는 Fully connection 방식
    장점 : 연결 안정성이 좋다
    단점 : 각 클라이언트가 관리해야하는 커넥션수가 많다

Relay 서버 방식 : 서버가 클라이언트와 연결되는 방식
    장점 : 서버가 방장이기때문에 공정한 게임운영이 가능하다.
    단점 : 서버가 죽었을 때, 게임 자체가 플레이가 안될수있다.

보통 서버를 많이 사용하여 연결하는 방식을 사용하는데, 그 이유는 P2P 연결방식의 치명적인 문제점이 있기 때문이다.
    문제점 : 우선 연결을 하려면 상대방의 주소(IP)를 알고 있어야 한다. 하지만, 고정 IP를 각 클라이언트마다 주기에는 
             IP주소의 양의 제한적이고, 고정 IP는 게이트웨이가 가지고 있고 클라이언트 들은 사설 IP가 주어지기 때문에 
             클라이언트는 상대 클라이언트의 주소를 정확히 알 수 없다.
             그러므로, 송신측에서 정확히 IP를 알고 수신측으로 전달하지 못한다.
             * 하지만, 그렇다고 해서 P2P 서버 방식이 완전히 불가능한 방식이 아니다. 
                       이러한 문제점을 해결하기위해 홀펀칭이라는 방법이 존재한다.

홀펀칭 : UDP를 기반으로 한 기술, NAT라는 네트워크 장비에 TCP/UDP 통신이 불가능한 Peer들간에 
         P2P 통신이 가능할 수 있도록 IP,PORT를 확보하는 기술이다.


ref: https://youtu.be/iVXkThB4tmA
</pre>


             
